{% extends 'base.html.twig' %}

{% block body %}
    <a href="{{ path('app_logout') }}">Cerrar Sesión</a>

    <h1>Task list</h1>
    {% for task in tasks %}
        <div class="bg-white shadow-md rounded-lg p-6 mb-4">
            <h2 class="text-xl font-bold text-gray-800 mb-2">{{ task.title }}</h2>
            <p class="text-gray-600 mb-4">{{ task.description }}</p>
            <p class="text-sm text-gray-500">Hacer antes de: {{ task.dueDate | date('d-m-Y H:i') }}</p>
            <div class="text-sm text-gray-500">
                {% if is_granted('TASK_EDIT', task) %}
                    <a href="{{ path('app_task_edit', { id: task.id }) }}">Editar</a>
                {% endif %}
                {% if is_granted('TASK_DELETE', task) %}
                    <form method="post" action="{{ path('app_task_delete', { id: task.id }) }}" onsubmit="return confirm('¿Estás seguro de eliminar esta tarea?');">
                        <button type="submit">Eliminar</button>
                    </form>
                {% endif %}
            </div>
        </div>
    {% else %}
        <p>Hola {{ user.email }}, no tienes tareas pendientes.</p>
        <p>Añade alguna tarea y diviertete.</p>
    {% endfor %}

{% endblock %}
